# å‰ç«¯æ¶æ„è®¾è®¡

> **æœ€åæ›´æ–°**: 2026-02-04
> **ç‰ˆæœ¬**: v1.0
> **çŠ¶æ€**: ğŸŸ¢ Active

---

## ç›®å½•

- [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
- [æŠ€æœ¯é€‰å‹](#æŠ€æœ¯é€‰å‹)
- [æ ¸å¿ƒè®¾è®¡æ¨¡å¼](#æ ¸å¿ƒè®¾è®¡æ¨¡å¼)
- [UI äº¤äº’æ¶æ„](#ui-äº¤äº’æ¶æ„)
- [çŠ¶æ€ç®¡ç†æ¶æ„](#çŠ¶æ€ç®¡ç†æ¶æ„)
- [é¡µé¢æ¶æ„](#é¡µé¢æ¶æ„)
- [ç»„ä»¶æ¶æ„](#ç»„ä»¶æ¶æ„)
- [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)

---

## æ¶æ„æ¦‚è§ˆ

Vision-Jarvis å‰ç«¯é‡‡ç”¨ **Astro Islands æ¶æ„** + **React ç»„ä»¶**æ··åˆæ–¹æ¡ˆï¼Œå®ç°é«˜æ€§èƒ½å’Œä¸°å¯Œäº¤äº’çš„å¹³è¡¡ã€‚

### æ ¸å¿ƒæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Vision-Jarvis å‰ç«¯                     â”‚
â”‚                  (Astro + React Hybrid)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           Presentation Layer (è§†å›¾å±‚)            â”‚    â”‚
â”‚  â”‚                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ Astro Pages    â”‚  â”‚ React Components     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ (.astro)       â”‚  â”‚ (Islands)            â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                â”‚  â”‚                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ - index        â”‚  â”‚ - FloatingOrb        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ - memory       â”‚  â”‚ - Header / Asker     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ - popup-settingâ”‚  â”‚ - MemoryList         â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚          State Management Layer (çŠ¶æ€å±‚)         â”‚    â”‚
â”‚  â”‚                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚
â”‚  â”‚  â”‚ memoryStore  â”‚  â”‚ settingStore â”‚  â”‚uiStore â”‚â”‚    â”‚
â”‚  â”‚  â”‚ (Nanostores) â”‚  â”‚ (Nanostores) â”‚  â”‚        â”‚â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Integration Layer (é›†æˆå±‚)               â”‚    â”‚
â”‚  â”‚                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚         Tauri IPC Bridge                   â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  - invoke()                                â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  - listen()                                â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  - emit()                                  â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†• Tauri IPC
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½ï¿½â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Rust Backend (Tauri)                    â”‚
â”‚  - Memory Service                                         â”‚
â”‚  - Screenshot Service                                     â”‚
â”‚  - AI Service                                             â”‚
â”‚  - Notification Service                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æŠ€æœ¯é€‰å‹

### æ ¸å¿ƒæ¡†æ¶

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | é€‰å‹ç†ç”± |
|------|------|------|---------|
| **Astro** | v5.x | é™æ€ç«™ç‚¹ç”Ÿæˆ | é›¶ JS é»˜è®¤è¾“å‡ºï¼Œæ€§èƒ½æä½³ |
| **React** | v18.x | äº¤äº’ç»„ä»¶ | ç”Ÿæ€ä¸°å¯Œï¼Œå›¢é˜Ÿç†Ÿæ‚‰ |
| **TypeScript** | v5.x | ç±»å‹ç³»ç»Ÿ | ç±»å‹å®‰å…¨ï¼Œå¼€å‘ä½“éªŒå¥½ |
| **Tauri** | v2.x | æ¡Œé¢åº”ç”¨æ¡†æ¶ | è½»é‡ã€å®‰å…¨ã€è·¨å¹³å° |

### çŠ¶æ€ç®¡ç†

| æŠ€æœ¯ | ç”¨é€” | é€‰å‹ç†ç”± |
|------|------|---------|
| **Nanostores** | å…¨å±€çŠ¶æ€ | è½»é‡ï¼ˆ1KBï¼‰ï¼Œæ¡†æ¶æ— å…³ï¼Œæ”¯æŒ Astro + React |
| **React Hooks** | ç»„ä»¶çŠ¶æ€ | åŸç”Ÿæ”¯æŒï¼Œç®€å•é«˜æ•ˆ |

### æ ·å¼æ–¹æ¡ˆ

| æŠ€æœ¯ | ç”¨é€” | é€‰å‹ç†ç”± |
|------|------|---------|
| **Tailwind CSS** | åŸå­åŒ– CSS | å¼€å‘æ•ˆç‡é«˜ï¼Œä½“ç§¯å¯æ§ |
| **CSS Modules** | å±€éƒ¨æ ·å¼ | é¿å…æ ·å¼å†²çª |
| **Framer Motion** | åŠ¨ç”»åº“ | å£°æ˜å¼åŠ¨ç”»ï¼Œæ€§èƒ½å¥½ |

---

## æ ¸å¿ƒè®¾è®¡æ¨¡å¼

### 1. Astro Islands æ¶æ„

**ç†å¿µ**: "éƒ¨åˆ†æ°´åˆ"ï¼ˆPartial Hydrationï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Astro Page (çº¯ HTML)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Static Content (æ—  JS)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  React Island 1 (äº¤äº’ç»„ä»¶)     â”‚  â”‚ â† ä»…æ­¤éƒ¨åˆ†æœ‰ JS
â”‚  â”‚  <FloatingOrb client:load />   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Static Content (æ—  JS)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜åŠ¿**:
- âœ… å‡å°‘ JS æ‰“åŒ…ä½“ç§¯ï¼ˆä»…äº¤äº’éƒ¨åˆ†æœ‰ JSï¼‰
- âœ… é¦–å±åŠ è½½é€Ÿåº¦å¿«
- âœ… SEO å‹å¥½ï¼ˆè™½ç„¶æ¡Œé¢åº”ç”¨ä¸éœ€è¦ï¼‰

### 2. ç»„ä»¶æ‡’åŠ è½½ç­–ç•¥

```typescript
// ä¸åŒåŠ è½½ç­–ç•¥
<FloatingOrb client:load />        // é¡µé¢åŠ è½½æ—¶ç«‹å³åŠ è½½
<MemoryList client:visible />      // å¯è§æ—¶åŠ è½½
<Asker client:idle />              // æµè§ˆå™¨ç©ºé—²æ—¶åŠ è½½
<SettingCard client:only="react"/> // ä»… React ç¯å¢ƒåŠ è½½
```

### 3. å•å‘æ•°æ®æµ

```
User Action (ç”¨æˆ·æ“ä½œ)
    â†“
UI Component (ç»„ä»¶)
    â†“
Store Action (çŠ¶æ€æ›´æ–°)
    â†“
Tauri Command (è°ƒç”¨åç«¯)
    â†“
Backend Service (åç«¯å¤„ç†)
    â†“
Event Emitted (äº‹ä»¶é€šçŸ¥)
    â†“
Store Updated (çŠ¶æ€åŒæ­¥)
    â†“
UI Re-render (ç•Œé¢åˆ·æ–°)
```

---

## UI äº¤äº’æ¶æ„

### æ‚¬æµ®çª—ä¸‰æ€è®¾è®¡

Vision-Jarvis çš„æ ¸å¿ƒ UI é‡‡ç”¨**æ¸è¿›å¼äº¤äº’**è®¾è®¡:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ‚¬æµ®çª—äº¤äº’çŠ¶æ€æœº                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

State 1: Idle (é»˜è®¤æ€)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    â—     â”‚  â† åœ†å½¢æ‚¬æµ®çƒï¼ˆ40x40pxï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  - ä½ç½®: å±å¹•å³ä¾§ä¸­å¤®
  - é€æ˜åº¦: 80%
  - è¡Œä¸º: å¯æ‹–åŠ¨

      â†“ (é¼ æ ‡æ‚¬åœ)

State 2: Header (æ‚¬åœæ€)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ§  [å…¨å±€è®°å¿†: ON]  ğŸ“‹ è®°å¿†  âš™ï¸ è®¾ç½® â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  - å±•å¼€å®½åº¦: 300px
  - åŠ¨ç”»: ä»å³å‘å·¦æ»‘å…¥ (300ms ease-out)
  - åŠŸèƒ½:
    1. å…¨å±€è®°å¿†å¼€å…³ï¼ˆToggleï¼‰
    2. è®°å¿†ç®¡ç†ï¼ˆè·³è½¬ /memoryï¼‰
    3. æé†’è®¾ç½®ï¼ˆè·³è½¬ /popup-settingï¼‰

      â†“ (ç‚¹å‡»æ‚¬æµ®çƒ)

State 3: Asker (ç‚¹å‡»æ€)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¤– é—®æˆ‘ä»»ä½•è®°å¿†ç›¸å…³çš„é—®é¢˜...       â”‚
â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è¾“å…¥æ¡† (å‘é‡æœç´¢)             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚
â”‚  å†å²å¯¹è¯:                         â”‚
â”‚  - Q: ä¸Šåˆåšäº†ä»€ä¹ˆ?                â”‚
â”‚  - A: æ‚¨ä¸Šåˆä¸»è¦...               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  - å±•å¼€é«˜åº¦: 400px
  - åŠ¨ç”»: ä»ä¸‹å‘ä¸Šæ»‘å…¥ (400ms ease-out)
  - åŠŸèƒ½: å‘é‡æœç´¢é—®ç­”ã€å¤šè½®å¯¹è¯
```

### çŠ¶æ€è½¬æ¢è§„åˆ™

```typescript
// çŠ¶æ€è½¬æ¢é€»è¾‘
type FloatingState = 'idle' | 'header' | 'asker';

const transitions = {
  idle: {
    onMouseEnter: 'header',
    onClick: 'asker'
  },
  header: {
    onMouseLeave: 'idle',
    onClick: 'asker'
  },
  asker: {
    onClickOutside: 'idle',
    onEscape: 'idle'
  }
};
```

---

## çŠ¶æ€ç®¡ç†æ¶æ„

### Nanostores è®¾è®¡

```typescript
// stores/memoryStore.ts
import { atom, map } from 'nanostores';

// å…¨å±€è®°å¿†å¼€å…³çŠ¶æ€
export const memoryEnabled = atom<boolean>(true);

// çŸ­æœŸè®°å¿†åˆ—è¡¨
export const shortTermMemories = map<{
  date: string;
  items: ShortTermMemory[];
}>({
  date: new Date().toISOString(),
  items: []
});

// é•¿æœŸè®°å¿†æ€»ç»“
export const longTermSummary = map<{
  dateRange: [string, string];
  summary: string;
  events: Event[];
}>({
  dateRange: ['', ''],
  summary: '',
  events: []
});

// é€‰ä¸­çš„è®°å¿†é¡¹
export const selectedMemory = atom<ShortTermMemory | null>(null);
```

```typescript
// stores/settingStore.ts
import { map } from 'nanostores';

export const settings = map({
  // å¯åŠ¨è®¾ç½®
  autoStart: true,
  startupMessage: "If today were the last day of my life...",

  // å®šæ—¶æé†’
  timedReminder: {
    enabled: false,
    timeRange: { start: '09:00', end: '21:00' },
    interval: 30 // åˆ†é’Ÿ
  },

  // æ— å˜åŒ–æé†’
  idleReminder: {
    enabled: false,
    idleThreshold: 15 // åˆ†é’Ÿ
  },

  // æˆªå±è®¾ç½®
  screenshot: {
    frequency: 5, // ç§’
    storagePath: '/default/path',
    maxSize: 1024 // MB
  }
});
```

```typescript
// stores/uiStore.ts
import { atom } from 'nanostores';

// UI çŠ¶æ€
export const floatingState = atom<'idle' | 'header' | 'asker'>('idle');
export const currentPage = atom<'index' | 'memory' | 'popup-setting'>('index');
export const isLoading = atom<boolean>(false);
export const errorMessage = atom<string | null>(null);
```

### çŠ¶æ€æ›´æ–°æ¨¡å¼

```typescript
// ç¤ºä¾‹: åˆ‡æ¢å…¨å±€è®°å¿†
import { memoryEnabled } from '@/stores/memoryStore';
import { invoke } from '@tauri-apps/api/core';

async function toggleMemory() {
  const currentState = memoryEnabled.get();
  const newState = !currentState;

  // 1. ä¹è§‚æ›´æ–° UI
  memoryEnabled.set(newState);

  try {
    // 2. è°ƒç”¨åç«¯
    await invoke('toggle_memory', { enabled: newState });
  } catch (error) {
    // 3. å¤±è´¥å›æ»š
    memoryEnabled.set(currentState);
    console.error('Failed to toggle memory:', error);
  }
}
```

---

## é¡µé¢æ¶æ„

### é¡µé¢è®¾è®¡

| é¡µé¢ | è·¯ç”± | ç”¨é€” | ä¸»è¦ç»„ä»¶ |
|------|------|------|---------|
| **ä¸»é¡µ** | `/` (index.astro) | æ‚¬æµ®çª—å…¥å£ | FloatingOrb, Header, Asker |
| **è®°å¿†ç®¡ç†** | `/memory` | æŸ¥çœ‹å’Œç®¡ç†è®°å¿† | MemoryList, DatePicker, MemoryCard |
| **æé†’è®¾ç½®** | `/popup-setting` | é…ç½®æé†’è§„åˆ™ | SettingCard |
| **ä»»åŠ¡è¿½è¸ª** | `/task-tracker` | ä»»åŠ¡ç®¡ç†ï¼ˆå¾…å¼€å‘ï¼‰ | - |
| **API ç®¡ç†** | `/api-management` | API é…ç½®ï¼ˆå¾…å¼€å‘ï¼‰ | - |

### é¡µé¢ç»“æ„æ¨¡æ¿

```astro
---
// src/pages/memory.astro
import Layout from '@/layouts/Layout.astro';
import MemoryList from '@/components/MemoryList';
import DatePicker from '@/components/DatePicker';
---

<Layout title="è®°å¿†ç®¡ç† - Vision-Jarvis">
  <div class="memory-page">
    <!-- å·¦ä¾§ Sidebar -->
    <aside class="sidebar">
      <DatePicker client:load />
      <MemoryList client:visible />
    </aside>

    <!-- å³ä¾§ä¸»å†…å®¹ -->
    <main class="content">
      <slot /> <!-- React ç»„ä»¶æ’æ§½ -->
    </main>
  </div>
</Layout>
```

---

## ç»„ä»¶æ¶æ„

### ç»„ä»¶åˆ†ç±»

```
components/
â”œâ”€â”€ core/              # æ ¸å¿ƒäº¤äº’ç»„ä»¶
â”‚   â”œâ”€â”€ FloatingOrb.tsx
â”‚   â”œâ”€â”€ Header.tsx
â”‚   â””â”€â”€ Asker.tsx
â”œâ”€â”€ memory/            # è®°å¿†ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ MemoryList.tsx
â”‚   â”œâ”€â”€ MemoryCard.tsx
â”‚   â”œâ”€â”€ DatePicker.tsx
â”‚   â””â”€â”€ FloatingInput.tsx
â”œâ”€â”€ settings/          # è®¾ç½®ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ SettingCard.tsx
â”‚   â”œâ”€â”€ ToggleSwitch.tsx
â”‚   â””â”€â”€ TimeRangePicker.tsx
â””â”€â”€ ui/                # é€šç”¨ UI ç»„ä»¶
    â”œâ”€â”€ Button.tsx
    â”œâ”€â”€ Input.tsx
    â”œâ”€â”€ Card.tsx
    â””â”€â”€ Modal.tsx
```

### ç»„ä»¶è®¾è®¡åŸåˆ™

1. **å•ä¸€èŒè´£**: æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
2. **Props ç±»å‹åŒ–**: ä¸¥æ ¼çš„ TypeScript ç±»å‹å®šä¹‰
3. **å¯ç»„åˆæ€§**: å°ç»„ä»¶ç»„åˆæˆå¤§ç»„ä»¶
4. **å¯æµ‹è¯•æ€§**: æ˜“äºç¼–å†™å•å…ƒæµ‹è¯•

### ç»„ä»¶é€šä¿¡æ¨¡å¼

```typescript
// çˆ¶ â†’ å­: Props
<MemoryCard memory={memoryData} />

// å­ â†’ çˆ¶: Callback
<DatePicker onDateChange={(date) => handleDateChange(date)} />

// å…„å¼Ÿç»„ä»¶: å…±äº« Store
// Component A
import { selectedMemory } from '@/stores/memoryStore';
selectedMemory.set(memory);

// Component B
import { useStore } from '@nanostores/react';
import { selectedMemory } from '@/stores/memoryStore';
const memory = useStore(selectedMemory);
```

---

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. ä»£ç åˆ†å‰²

```typescript
// æŒ‰è·¯ç”±åˆ†å‰²
const MemoryPage = lazy(() => import('./pages/MemoryPage'));
const SettingPage = lazy(() => import('./pages/SettingPage'));

// æŒ‰åŠŸèƒ½åˆ†å‰²
const AIChat = lazy(() => import('./components/AIChat'));
```

### 2. å›¾ç‰‡ä¼˜åŒ–

```astro
---
import { Image } from 'astro:assets';
import screenshot from '../assets/screenshot.png';
---

<Image
  src={screenshot}
  alt="Screenshot"
  width={800}
  height={600}
  loading="lazy"
  format="webp"
/>
```

### 3. è™šæ‹Ÿæ»šåŠ¨

```typescript
// é•¿åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
import { VirtualList } from '@/components/VirtualList';

<VirtualList
  items={memories}
  itemHeight={80}
  renderItem={(memory) => <MemoryCard memory={memory} />}
/>
```

### 4. é˜²æŠ–å’ŒèŠ‚æµ

```typescript
// æœç´¢è¾“å…¥é˜²æŠ–
import { debounce } from 'lodash-es';

const handleSearch = debounce((query: string) => {
  searchMemories(query);
}, 300);

// æ»šåŠ¨äº‹ä»¶èŠ‚æµ
import { throttle } from 'lodash-es';

const handleScroll = throttle(() => {
  updateScrollPosition();
}, 100);
```

### 5. Tauri IPC ä¼˜åŒ–

```typescript
// æ‰¹é‡è¯·æ±‚
async function loadMemoriesOptimized() {
  // âŒ å¤šæ¬¡è¯·æ±‚
  // const memories = await Promise.all(
  //   dates.map(date => invoke('get_memories', { date }))
  // );

  // âœ… å•æ¬¡æ‰¹é‡è¯·æ±‚
  const memories = await invoke('get_memories_batch', { dates });
}

// è¯·æ±‚ç¼“å­˜
const cache = new Map();
async function getMemory(id: string) {
  if (cache.has(id)) return cache.get(id);
  const memory = await invoke('get_memory', { id });
  cache.set(id, memory);
  return memory;
}
```

---

## å…³é”®è®¾è®¡å†³ç­–

### â“ ä¸ºä»€ä¹ˆé€‰æ‹© Astro + React?

| æ–¹æ¡ˆ | ä¼˜åŠ¿ | åŠ£åŠ¿ | å†³ç­– |
|------|------|------|------|
| **çº¯ React** | ç”Ÿæ€ä¸°å¯Œ | æ‰“åŒ…ä½“ç§¯å¤§ï¼Œé¦–å±æ…¢ | âŒ |
| **çº¯ Astro** | æ€§èƒ½æä½³ | äº¤äº’å—é™ | âŒ |
| **Astro + React** | æ€§èƒ½ + äº¤äº’å…¼å¾— | å­¦ä¹ æˆæœ¬ç¨é«˜ | âœ… é€‰æ‹© |

### â“ ä¸ºä»€ä¹ˆé€‰æ‹© Nanostores?

| æ–¹æ¡ˆ | ä¼˜åŠ¿ | åŠ£åŠ¿ | å†³ç­– |
|------|------|------|------|
| **Redux** | æˆç†Ÿç¨³å®š | ä½“ç§¯å¤§ï¼ˆ45KBï¼‰ï¼Œæ ·æ¿ä»£ç å¤š | âŒ |
| **Zustand** | ç®€æ´ | ä¸æ”¯æŒ Astro | âŒ |
| **Nanostores** | æè½»é‡ï¼ˆ1KBï¼‰ï¼ŒAstro å®˜æ–¹æ¨è | ç”Ÿæ€å° | âœ… é€‰æ‹© |

### â“ ä¸ºä»€ä¹ˆç”¨ Tailwind CSS?

- âœ… åŸå­åŒ– CSSï¼Œå¼€å‘æ•ˆç‡é«˜
- âœ… æŒ‰éœ€ç”Ÿæˆï¼Œç”Ÿäº§ä½“ç§¯å°
- âœ… çº¦æŸè®¾è®¡ï¼Œä¿æŒä¸€è‡´æ€§
- âœ… ä¸ Astro/React é›†æˆå®Œç¾

---

## è¿ç§»å’Œå‡çº§

### ç‰ˆæœ¬å…¼å®¹æ€§

| ä¾èµ– | å½“å‰ç‰ˆæœ¬ | æœ€ä½ç‰ˆæœ¬ | å‡çº§è®¡åˆ’ |
|------|---------|---------|---------|
| Astro | 5.1.0 | 5.0.0 | ç¨³å®š |
| React | 18.3.1 | 18.0.0 | è€ƒè™‘ React 19 |
| Tauri | 2.1.0 | 2.0.0 | è·Ÿéšå®˜æ–¹ |
| TypeScript | 5.6.3 | 5.0.0 | ç¨³å®š |

---

## ç›¸å…³æ–‡æ¡£

- [ç»„ä»¶åº“æ–‡æ¡£](components/README.md)
- [çŠ¶æ€ç®¡ç†æ–‡æ¡£](state-management.md)
- [æ ·å¼è§„èŒƒ](styling.md)
- [åŠ¨ç”»è®¾è®¡](animations.md)
- [æ€§èƒ½ä¼˜åŒ–](../guides/best-practices.md)

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Vision-Jarvis æ¶æ„å›¢é˜Ÿ
**å®¡æ ¸çŠ¶æ€**: âœ… å·²å®¡æ ¸
**æœ€åæ›´æ–°**: 2026-02-04
