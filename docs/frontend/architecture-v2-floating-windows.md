# Frontend Architecture V2 - Floating Windows System

> **æ–‡æ¡£ç‰ˆæœ¬**: v2.0
> **åˆ›å»ºæ—¥æœŸ**: 2026-02-06
> **çŠ¶æ€**: Active
> **æ¶æ„ç±»å‹**: Multi-Window Floating Ball Architecture

---

## ç›®å½•

- [æ¦‚è§ˆ (Overview)](#æ¦‚è§ˆ-overview)
- [æ¶æ„æ¼”è¿›](#æ¶æ„æ¼”è¿›)
- [çª—å£ç»“æ„ (Window Structure)](#çª—å£ç»“æ„-window-structure)
- [çŠ¶æ€ç®¡ç† (State Management)](#çŠ¶æ€ç®¡ç†-state-management)
- [äº¤äº’æµç¨‹ (Interaction Flow)](#äº¤äº’æµç¨‹-interaction-flow)
- [æŠ€æœ¯å®ç°ç»†èŠ‚ (Technical Implementation)](#æŠ€æœ¯å®ç°ç»†èŠ‚-technical-implementation)
- [æ€§èƒ½ä¼˜åŒ– (Performance Optimizations)](#æ€§èƒ½ä¼˜åŒ–-performance-optimizations)
- [æ–‡ä»¶ç»„ç»‡ (File Organization)](#æ–‡ä»¶ç»„ç»‡-file-organization)
- [å…³é”®è®¾è®¡å†³ç­–](#å…³é”®è®¾è®¡å†³ç­–)

---

## æ¦‚è§ˆ (Overview)

Vision-Jarvis V2 é‡‡ç”¨**å¤šçª—å£æ‚¬æµ®çƒæ¶æ„**ï¼ˆMulti-Window Floating Ball Architectureï¼‰ï¼Œä»å•é¡µé¢åº”ç”¨é‡æ„ä¸ºç‹¬ç«‹çš„å¤šçª—å£ç³»ç»Ÿï¼Œå®ç° macOS é£æ ¼çš„æ‚¬æµ®çª—å£äº¤äº’ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **æ‚¬æµ®çƒä¸»çª—å£**: 64x64 åƒç´ åœ†å½¢çƒä½“ï¼Œå§‹ç»ˆç½®é¡¶ï¼Œæ”¯æŒä¸‰ç§çŠ¶æ€åˆ‡æ¢ï¼ˆBall â†’ Header â†’ Askerï¼‰
- **ç‹¬ç«‹åŠŸèƒ½çª—å£**: Memory å’Œ Popup-Setting ä½œä¸ºç‹¬ç«‹çª—å£è¿è¡Œï¼Œæ”¯æŒåŒæ—¶æ“ä½œ
- **æ¸è¿›å¼äº¤äº’**: é¼ æ ‡æ‚¬åœè‡ªåŠ¨å±•å¼€ Headerï¼Œç‚¹å‡»å±•å¼€ Askerï¼Œä¸æ»‘çš„åŠ¨ç”»æ•ˆæœ
- **å…¨å±€è®°å¿†æ§åˆ¶**: Header æä¾›å¿«é€Ÿå¼€å…³å…¨å±€è®°å¿†åŠŸèƒ½
- **çª—å£é€šä¿¡**: åŸºäº Tauri 2 çš„å¤šçª—å£ API å’Œçª—å£äº‹ä»¶ç®¡ç†
- **å¼€æœºè‡ªå¯åŠ¨**: æ”¯æŒç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æ˜¾ç¤ºæ‚¬æµ®çƒ

### æ¶æ„ç¤ºæ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Vision-Jarvis V2 æ¶æ„                      â”‚
â”‚              (Multi-Window Floating Ball System)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Floating Ballâ”‚   â”‚    Memory    â”‚   â”‚Popup-Setting â”‚
â”‚   Window     â”‚   â”‚   Window     â”‚   â”‚   Window     â”‚
â”‚  (Main)      â”‚   â”‚ (Independent)â”‚   â”‚ (Independent)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                   â”‚                   â”‚
â”‚ â€¢ 64x64px        â”‚ â€¢ 1200x800px     â”‚ â€¢ 900x700px
â”‚ â€¢ Always on top  â”‚ â€¢ Resizable      â”‚ â€¢ Resizable
â”‚ â€¢ Transparent    â”‚ â€¢ Full UI        â”‚ â€¢ Card Layout
â”‚ â€¢ 3 States:      â”‚ â€¢ Standalone     â”‚ â€¢ Settings
â”‚   - Ball         â”‚                   â”‚
â”‚   - Header       â”‚                   â”‚
â”‚   - Asker        â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¶æ„æ¼”è¿›

### V1 (å•é¡µé¢åº”ç”¨) â†’ V2 (å¤šçª—å£ç³»ç»Ÿ)

| ç»´åº¦ | V1 æ¶æ„ | V2 æ¶æ„ | æ”¹è¿›ç‚¹ |
|------|---------|---------|--------|
| **çª—å£æ¨¡å¼** | å•çª—å£ï¼Œæ‰€æœ‰åŠŸèƒ½åœ¨ä¸€ä¸ªé¡µé¢ | å¤šçª—å£ï¼ŒåŠŸèƒ½ç‹¬ç«‹åˆ†ç¦» | æ›´å¥½çš„å…³æ³¨ç‚¹åˆ†ç¦» |
| **ä¸»ç•Œé¢** | å…¨å±åº”ç”¨ | æ‚¬æµ®çƒï¼ˆ64x64pxï¼‰ | å‡å°‘è§†è§‰å¹²æ‰° |
| **äº¤äº’æ–¹å¼** | ç‚¹å‡»å¯¼èˆªé“¾æ¥ | æ¸è¿›å¼å±•å¼€ï¼ˆæ‚¬åœ/ç‚¹å‡»ï¼‰ | æ›´æµç•…çš„ç”¨æˆ·ä½“éªŒ |
| **è®°å¿†ç®¡ç†** | é¡µé¢å†…ç»„ä»¶ | ç‹¬ç«‹çª—å£ï¼ˆ1200x800ï¼‰ | å¯åŒæ—¶æ“ä½œå¤šä¸ªçª—å£ |
| **è®¾ç½®é¡µé¢** | é¡µé¢å†…ç»„ä»¶ | ç‹¬ç«‹çª—å£ï¼ˆ900x700ï¼‰ | å¹¶è¡Œé…ç½®å’Œä½¿ç”¨ |
| **ç½®é¡¶èƒ½åŠ›** | æ—  | ä¸»çª—å£å§‹ç»ˆç½®é¡¶ | éšæ—¶å¯è®¿é—® |
| **é€æ˜æ•ˆæœ** | æ—  | æ”¯æŒ macOS é€æ˜ | æ›´å¥½çš„è§†è§‰èåˆ |

### é‡æ„èŒƒå›´

**Phase 1**: Tauri çª—å£é…ç½®
- é…ç½®å¤šçª—å£ç³»ç»Ÿï¼ˆ`tauri.conf.json`ï¼‰
- æ·»åŠ çª—å£ç®¡ç† Commandsï¼ˆ`window.rs`ï¼‰

**Phase 2**: æ‚¬æµ®çƒä¸»çª—å£
- Ball ç»„ä»¶ï¼ˆåˆå§‹çŠ¶æ€ 64x64ï¼‰
- Header ç»„ä»¶ï¼ˆæ‚¬åœå±•å¼€ 360x72ï¼‰
- Asker ç»„ä»¶ï¼ˆç‚¹å‡»å±•å¼€ 360x480ï¼‰
- çŠ¶æ€ç®¡ç†å’Œäº¤äº’é€»è¾‘

**Phase 3**: Memory çª—å£é‡æ„
- ä»é¡µé¢ç»„ä»¶æ”¹ä¸ºç‹¬ç«‹çª—å£å¸ƒå±€
- å®Œæ•´çš„è®°å¿†ç®¡ç† UIï¼ˆ1200x800ï¼‰

**Phase 4**: Popup-Setting çª—å£é‡æ„
- ä»é¡µé¢ç»„ä»¶æ”¹ä¸ºç‹¬ç«‹çª—å£å¸ƒå±€
- å¡ç‰‡å¼è®¾ç½®é¡µé¢ï¼ˆ900x700ï¼‰

**Phase 5**: é›†æˆæµ‹è¯•å’Œä¼˜åŒ–
- ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆ11é¡¹æµ‹è¯•æ¸…å•ï¼‰
- æ€§èƒ½ä¼˜åŒ–ï¼ˆé˜²æŠ–ã€GPUåŠ é€Ÿï¼‰
- Bug ä¿®å¤ï¼ˆçª—å£æ ‡ç­¾ã€é€æ˜åº¦ï¼‰

---

## çª—å£ç»“æ„ (Window Structure)

### ä¸»çª—å£: Floating Ball

#### é…ç½®ï¼ˆtauri.conf.jsonï¼‰

```json
{
  "label": "floating-ball",
  "title": "Vision Jarvis",
  "url": "/floating-ball",
  "width": 64,
  "height": 64,
  "resizable": false,
  "decorations": false,
  "transparent": true,
  "alwaysOnTop": true,
  "skipTaskbar": true,
  "visible": true,
  "x": 1800,
  "y": 50
}
```

#### ä¸‰ç§çŠ¶æ€

| çŠ¶æ€ | å°ºå¯¸ | è§¦å‘æ–¹å¼ | å†…å®¹ | åŠ¨ç”»æ—¶é•¿ |
|------|------|----------|------|----------|
| **Ball** | 64x64 | é»˜è®¤çŠ¶æ€ | åœ†å½¢æ‚¬æµ®çƒ + è„‘å›¾æ ‡ | - |
| **Header** | 360x72 | é¼ æ ‡æ‚¬åœ (200ms å»¶è¿Ÿ) | å…¨å±€è®°å¿†å¼€å…³ã€è®°å¿†ç®¡ç†æŒ‰é’®ã€æé†’ç®¡ç†æŒ‰é’® | 300ms ease-out |
| **Asker** | 360x480 | ç‚¹å‡»æ‚¬æµ®çƒ | AI å¯¹è¯ç•Œé¢ï¼ˆå‘é‡æœç´¢é—®ç­”ã€å¤šè½®å¯¹è¯ï¼‰ | 400ms ease-out |

#### Header çŠ¶æ€è¯¦ç»†åŠŸèƒ½

**è§¦å‘**: é¼ æ ‡ç§»åŠ¨åˆ°æ‚¬æµ®çƒï¼Œ200ms å»¶è¿Ÿåè‡ªåŠ¨å±•å¼€

**å†…å®¹ç»„ä»¶**:
1. **å…¨å±€è®°å¿† Toggle å¼€å…³** (100pxå®½)
   - ON/OFF åˆ‡æ¢
   - ç»¿è‰²æ¸å˜æŒ‡ç¤ºå¼€å¯çŠ¶æ€
   - æ§åˆ¶æ•´ä¸ªåº”ç”¨çš„è®°å¿†æ•è·åŠŸèƒ½
   - æ”¯æŒå¼€æœºè‡ªå¯åŠ¨æ—¶è‡ªåŠ¨å¼€å¯

2. **è®°å¿†ç®¡ç†æŒ‰é’®**
   - ç‚¹å‡»åæ‰“å¼€ Memory ç‹¬ç«‹çª—å£
   - å›¾æ ‡: æ•°æ®åº“å›¾æ ‡
   - æ–‡æœ¬: "è®°å¿†"

3. **æé†’ç®¡ç†æŒ‰é’®**
   - ç‚¹å‡»åæ‰“å¼€ Popup-Setting ç‹¬ç«‹çª—å£
   - å›¾æ ‡: é“ƒé“›å›¾æ ‡
   - æ–‡æœ¬: "æé†’"

**äº¤äº’é€»è¾‘**:
- é¼ æ ‡ç§»å¼€ Header â†’ 300ms åè‡ªåŠ¨æŠ˜å å› Ball
- ç‚¹å‡»æŒ‰é’®åï¼Œæ‚¬æµ®çª—ä¿æŒå½“å‰çŠ¶æ€ä¸å˜ï¼ˆä¸æŠ˜å ï¼‰

#### Asker çŠ¶æ€è¯¦ç»†åŠŸèƒ½

**è§¦å‘**: ç‚¹å‡»æ‚¬æµ®çƒï¼ˆä»»æ„çŠ¶æ€ä¸‹ï¼‰

**åŠŸèƒ½**:
1. **å‘é‡æœç´¢é—®ç­”**
   - ç”¨æˆ·å¯ä»¥å¯¹è‡ªå·±çš„è®°å¿†è¿›è¡Œæœç´¢
   - åŸºäºå‘é‡æ•°æ®åº“çš„è¯­ä¹‰æœç´¢
   - æ”¯æŒè‡ªç„¶è¯­è¨€æé—®

2. **å¤šè½®å¯¹è¯**
   - ä¼ ç»Ÿé—®ç­”çª—å£äº¤äº’
   - ä¿æŒå¯¹è¯ä¸Šä¸‹æ–‡
   - æ”¯æŒè¿ç»­è¿½é—®

3. **UI ç»„ä»¶**:
   - **Header**: æ ‡é¢˜ "AI åŠ©æ‰‹" + å…³é—­æŒ‰é’®
   - **Messages åŒºåŸŸ**: æ˜¾ç¤ºå¯¹è¯å†å²ï¼ˆå¯æ»šåŠ¨ï¼‰
   - **Input åŒºåŸŸ**:
     - è¾“å…¥æ¡†: "è¾“å…¥é—®é¢˜..."
     - å‘é€æŒ‰é’®: åœ†å½¢æ¸å˜æŒ‰é’®

**äº¤äº’é€»è¾‘**:
- ç‚¹å‡»å¤–éƒ¨åŒºåŸŸ â†’ æŠ˜å å› Ball
- ç‚¹å‡»å…³é—­æŒ‰é’® â†’ æŠ˜å å› Ball
- è¾“å…¥é—®é¢˜å â†’ çª—å£ä¿æŒå±•å¼€

#### ç‰¹æ€§

- **å§‹ç»ˆç½®é¡¶** (`alwaysOnTop: true`): æµ®äºæ‰€æœ‰çª—å£ä¹‹ä¸Š
- **é€æ˜èƒŒæ™¯** (`transparent: true`): ä¸æ¡Œé¢èåˆ
- **æ— è¾¹æ¡†** (`decorations: false`): è‡ªå®šä¹‰æ‹–åŠ¨
- **è·³è¿‡ä»»åŠ¡æ ** (`skipTaskbar: true`): ä¸æ˜¾ç¤ºåœ¨ä»»åŠ¡æ 

---

### Memory Window

#### é…ç½®

```rust
WebviewWindowBuilder::new(
    &app,
    "memory",
    WebviewUrl::App("/memory".into())
)
.title("è®°å¿†ç®¡ç† - Vision Jarvis")
.inner_size(1200.0, 800.0)
.resizable(true)
.center()
.build()
```

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Memory Window (1200x800)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Sidebar   â”‚      Main Content Area             â”‚
â”‚  (320px)   â”‚      (880px)                       â”‚
â”‚            â”‚                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚è®°å¿†å¼€å…³â”‚ â”‚  â”‚ ğŸ” æœç´¢è®°å¿†/é—®ç­”æ¡†          â”‚  â”‚
â”‚ â”‚ ON/OFF â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  (æ‚¬æµ®è¾“å…¥æ¡†ï¼Œå§‹ç»ˆç½®é¡¶)            â”‚
â”‚            â”‚                                     â”‚
â”‚ æ—¥æœŸé€‰æ‹©   â”‚  é»˜è®¤æ˜¾ç¤º:                         â”‚
â”‚ 2026-02-08 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚      ğŸ§                        â”‚  â”‚
â”‚            â”‚  â”‚  æƒ³æ‰¾å“ªæ®µè®°å¿†                 â”‚  â”‚
â”‚ çŸ­æœŸè®°å¿†åˆ—è¡¨â”‚  â”‚  æˆ‘éƒ½è®°ç€å‘¢ï¼Œéšä¾¿é—®           â”‚  â”‚
â”‚ æ—© â”€â”€â”€â”€â”€â”€â”€ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ 10:00-11:00â”‚                                     â”‚
â”‚ ç¼–å†™ä»£ç    â”‚  é—®ç­”åæ˜¾ç¤º:                       â”‚
â”‚ 11:00-12:00â”‚  æ¨¡å‹è¿”å›ç»“æœï¼ˆåˆ‡æ¢å³ä¾§ä¸»å†…å®¹ï¼‰     â”‚
â”‚ ä¼šè®®è®¨è®º   â”‚                                     â”‚
â”‚ ä¸­ â”€â”€â”€â”€â”€â”€â”€ â”‚  çŸ­æœŸè®°å¿†å±•ç¤º:                     â”‚
â”‚ ...        â”‚  â€¢ æ ‡é¢˜: äº‹é¡¹åç§°                  â”‚
â”‚            â”‚  â€¢ æ—¶é—´çº¿: å¯¹åº”å›¾ç‰‡ç´¢å¼•åˆ†æ        â”‚
â”‚ è®¾ç½®       â”‚  â€¢ ç»“å°¾: äº‹é¡¹å»ºè®®ä¸åˆ†æ            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                     â”‚
â”‚ â”‚æˆªå±é¢‘ç‡â”‚ â”‚  é•¿æœŸè®°å¿†å±•ç¤º:                     â”‚
â”‚ â”‚1s - 15sâ”‚ â”‚  â€¢ æ—¥æœŸèŒƒå›´ + äº‹é¡¹æ€»ç»“             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â€¢ ä¸»è¦äº‹é¡¹ä¸æ—¥æœŸæ¦‚è§ˆ              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                     â”‚
â”‚ â”‚å­˜å‚¨è®¾ç½®â”‚ â”‚                                     â”‚
â”‚ â”‚ğŸ“ ğŸ“Š  â”‚ â”‚                                     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å·¦ä¾§è¾¹æ åŠŸèƒ½

1. **è®°å¿†åŠŸèƒ½å¼€å…³ (é¡¶éƒ¨)**
   - ç»§ç»­æˆ–ç»ˆæ­¢è®°å¿†åŠŸèƒ½çš„æ¨¡å¼åˆ‡æ¢
   - å¤§å· Toggle æŒ‰é’®

2. **æ—¥æœŸé€‰æ‹©å™¨**
   - é»˜è®¤æ˜¾ç¤ºå½“å¤©æ—¥æœŸ
   - **ç‚¹å‡»æ—¥æœŸ**: æ”¯æŒæ—¥æœŸé€‰æ‹© â†’ è·³è½¬åˆ°å¯¹åº”çŸ­æœŸè®°å¿†åˆ—è¡¨
   - **æ—¥æœŸèŒƒå›´é€‰æ‹©**: é€‰å®Œåå¼¹çª—è¯¢é—®æ˜¯å¦è¿›è¡Œé•¿æœŸè®°å¿†åˆ†æ

3. **çŸ­æœŸè®°å¿†åˆ—è¡¨**
   - **æ—¶æ®µåˆ†éš”çº¿**: æ—©ã€ä¸­ã€æ™šä¸‰ä¸ªæ—¶æ®µåˆ†éš”
   - **äº‹é¡¹æŒ‰é’®**:
     - æ˜¾ç¤ºæ—¶é—´çº¿: "10:00-11:00"
     - æ˜¾ç¤ºäº‹é¡¹å†…å®¹æ‘˜è¦
     - ç‚¹å‡»ååœ¨å³ä¾§æ˜¾ç¤ºè¯¦ç»†å†…å®¹

4. **æˆªå±åˆ†æé¢‘ç‡è®¾ç½®**
   - æ»‘åŠ¨æ¡: 1s ~ 15s
   - å®æ—¶æ˜¾ç¤ºå½“å‰è®¾ç½®å€¼

5. **æˆªå±å†…å­˜æ–‡ä»¶è®¾ç½®**
   - **æ–‡ä»¶æŒ‰é’®** (ğŸ“): è®¾ç½®é»˜è®¤è®°å¿†æ–‡ä»¶å­˜å‚¨ä½ç½®
   - **å†…å­˜å¤§å°** (ğŸ“Š): è®¾ç½®è‡ªåŠ¨åˆ é™¤ä¸Šé™

#### å³ä¾§ä¸»å†…å®¹åŒºåŠŸèƒ½

1. **æ‚¬æµ®æœç´¢/é—®ç­”æ¡†** (å§‹ç»ˆç½®é¡¶äºå†…å®¹åŒº)
   - å¯ç”¨äºæœç´¢è®°å¿†
   - å¯ç”¨äºå‘é‡é—®ç­”
   - é—®ç­”ååˆ‡æ¢å³ä¾§ä¸»å†…å®¹æ˜¾ç¤º

2. **é»˜è®¤çŠ¶æ€**
   - å±…ä¸­æ˜¾ç¤ºæç¤ºæ–‡æœ¬
   - "æƒ³æ‰¾å“ªæ®µè®°å¿†ï¼Œæˆ‘éƒ½è®°ç€å‘¢ï¼Œéšä¾¿é—®"

3. **çŸ­æœŸè®°å¿†äº‹é¡¹å±•ç¤º**
   - **æ ‡é¢˜**: äº‹é¡¹åç§°
   - **æ­£æ–‡**:
     - äº‹é¡¹å…·ä½“æ—¶é—´çº¿
     - å¯¹åº”å›¾ç‰‡ç´¢å¼•
     - AI åˆ†ææ€»ç»“åˆ—è¡¨
   - **ç»“å°¾**: äº‹é¡¹å»ºè®®ä¸åˆ†æ

4. **é•¿æœŸè®°å¿†æ€»ç»“å±•ç¤º**
   - **æ ‡é¢˜**: æ—¥æœŸèŒƒå›´ + äº‹é¡¹æ€»ç»“
   - **å†…å®¹**: ä¸»è¦äº‹é¡¹ä¸å¯¹åº”æ—¥æœŸæ¦‚è§ˆ

---

### Popup-Setting Window

#### é…ç½®

```rust
WebviewWindowBuilder::new(
    &app,
    "popup-setting",
    WebviewUrl::App("/popup-setting".into())
)
.title("æé†’è®¾ç½® - Vision Jarvis")
.inner_size(900.0, 700.0)
.resizable(true)
.center()
.build()
```

#### å¸ƒå±€ç»“æ„ï¼ˆå¡ç‰‡å¼ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Popup-Setting Window (900x700)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Header                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“‹ æé†’è®¾ç½®                                â”‚ â”‚
â”‚  â”‚ é…ç½®æ‚¨çš„æ™ºèƒ½æé†’å’Œé€šçŸ¥                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€ Card 1: å¯åŠ¨æé†’ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚  å¯åŠ¨æé†’              [Toggle ON]  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  åº”ç”¨å¯åŠ¨æ—¶å¼¹å‡ºæ¿€åŠ±å†…å®¹             â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚ å¼€æœºè‡ªåŠ¨å¯åŠ¨:         [Toggle ON]      â”‚   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚ å¼¹å‡ºæ–‡æœ¬è®¾ç½®:                           â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚ â”‚ If today were the last day of my  â”‚  â”‚   â”‚
â”‚  â”‚ â”‚ life, would I want to do what I   â”‚  â”‚   â”‚
â”‚  â”‚ â”‚ am about to do today?             â”‚  â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€ Card 2: å®šæ—¶æé†’ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚  å®šæ—¶æé†’              [Toggle ON]  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  å·¥ä½œæ—¶æ®µå®šæœŸæé†’ä¼‘æ¯               â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚ å·¥ä½œæ—¶é—´æ®µ:                             â”‚   â”‚
â”‚  â”‚ [09:00] è‡³ [21:00]                     â”‚   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚ æé†’é—´éš”:              æ¯ 30 åˆ†é’Ÿ       â”‚   â”‚
â”‚  â”‚ â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‹            â”‚   â”‚
â”‚  â”‚ 5åˆ†é’Ÿ                    120åˆ†é’Ÿ        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€ Card 3: ç©ºé—²æ£€æµ‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚  ç©ºé—²æ£€æµ‹              [Toggle ON]  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚  æ£€æµ‹å±å¹•æ— å˜åŒ–å¹¶æé†’               â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚ ç©ºé—²åˆ¤å®šæ—¶é•¿:          15 åˆ†é’Ÿ         â”‚   â”‚
â”‚  â”‚ â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‹                        â”‚   â”‚
â”‚  â”‚ 5åˆ†é’Ÿ                         60åˆ†é’Ÿ    â”‚   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚ æé†’å†…å®¹:                               â”‚   â”‚
â”‚  â”‚ [â–¼ AI æ™ºèƒ½å»ºè®®]                        â”‚   â”‚
â”‚  â”‚    - AI æ™ºèƒ½å»ºè®®                       â”‚   â”‚
â”‚  â”‚    - ä¼‘æ¯æé†’                          â”‚   â”‚
â”‚  â”‚    - è‡ªå®šä¹‰æ–‡æœ¬                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å¡ç‰‡åŠŸèƒ½è¯¦è§£

**Card 1: å¯åŠ¨æé†’**
1. **åŠŸèƒ½å¼€å…³** (Toggle)
   - æ§åˆ¶å¯åŠ¨æé†’æ˜¯å¦å¯ç”¨

2. **å¼€æœºè‡ªåŠ¨å¯åŠ¨å¼€å…³**
   - ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨åº”ç”¨

3. **å¼¹å‡ºæ–‡æœ¬è®¾ç½®**
   - å¯ç¼–è¾‘æ–‡æœ¬æ¡†
   - é»˜è®¤å€¼: "If today were the last day of my life, would I want to do what I am about to do today?"
   - æ”¯æŒè‡ªå®šä¹‰æ¿€åŠ±æ–‡æœ¬

**Card 2: å®šæ—¶æé†’**
1. **åŠŸèƒ½å¼€å…³** (Toggle)
   - æ§åˆ¶å®šæ—¶æé†’æ˜¯å¦å¯ç”¨

2. **æ—¶é—´èŒƒå›´é€‰æ‹©**
   - å¼€å§‹æ—¶é—´é€‰æ‹©å™¨ (å¦‚ 09:00)
   - ç»“æŸæ—¶é—´é€‰æ‹©å™¨ (å¦‚ 21:00)
   - å®šä¹‰å·¥ä½œæ—¶æ®µ

3. **é—´éš”æ—¶é•¿è®¾ç½®**
   - æ»‘åŠ¨æ¡: 5åˆ†é’Ÿ ~ 120åˆ†é’Ÿ
   - å®æ—¶æ˜¾ç¤ºå½“å‰å€¼: "æ¯ 30 åˆ†é’Ÿ"
   - æ­¥é•¿: 5åˆ†é’Ÿ

**Card 3: ç©ºé—²æ£€æµ‹**
1. **åŠŸèƒ½å¼€å…³** (Toggle)
   - æ§åˆ¶ç©ºé—²æ£€æµ‹æ˜¯å¦å¯ç”¨

2. **æ— å˜åŒ–æ—¶é•¿åˆ¤æ–­è®¾ç½®**
   - æ»‘åŠ¨æ¡: 5åˆ†é’Ÿ ~ 60åˆ†é’Ÿ
   - å®æ—¶æ˜¾ç¤ºå½“å‰å€¼: "15 åˆ†é’Ÿ"
   - æ­¥é•¿: 5åˆ†é’Ÿ
   - ç”¨é€”: xxåˆ†é’Ÿå†…æ— æ“ä½œè®¤å®šç”¨æˆ·ç¦»å¼€

3. **æé†’å†…å®¹ç±»å‹é€‰æ‹©**
   - ä¸‹æ‹‰èœå•
   - é€‰é¡¹:
     - AI æ™ºèƒ½å»ºè®® (é»˜è®¤)
     - ä¼‘æ¯æé†’
     - è‡ªå®šä¹‰æ–‡æœ¬

#### è®¾è®¡ç‰¹ç‚¹

- **å¡ç‰‡å¼å¸ƒå±€**: ä¾¿äºåç»­æ·»åŠ æ–°çš„æé†’ç±»å‹
- **å¯æ‰©å±•æ€§**: æ”¯æŒæ·»åŠ  Card 4ã€Card 5 ç­‰
- **ä¸€è‡´æ€§**: æ‰€æœ‰å¡ç‰‡éµå¾ªç›¸åŒçš„è®¾è®¡æ¨¡å¼ï¼ˆToggle + é…ç½®é¡¹ï¼‰

---

### API ç®¡ç†é¡µ (API Settings)

#### é…ç½®

```rust
WebviewWindowBuilder::new(
    &app,
    "api-settings",
    WebviewUrl::App("/api-settings".into())
)
.title("API é…ç½® - Vision Jarvis")
.inner_size(900.0, 700.0)
.resizable(true)
.center()
.build()
```

#### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       API Settings Window (900x700)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Header                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”Œ AI æä¾›å•†é…ç½®                           â”‚ â”‚
â”‚  â”‚ ç®¡ç†æ‚¨çš„ AI æœåŠ¡ API å¯†é’¥å’Œæ¨¡å‹           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€ å®˜æ–¹ä¾›åº”å•† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚  Claude (Anthropic)                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ API Key:                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ [sk-ant-api03-***************]  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ æ¨¡å‹åç§°:                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ [â–¼ claude-sonnet-4-5-20250929] â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    - claude-opus-4-6           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    - claude-sonnet-4-5-20250929â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    - claude-haiku-4-5          â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚  OpenAI                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ API Key: [******************]   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ æ¨¡å‹: [â–¼ gpt-4-turbo]          â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€ ä¸‰æ–¹ä¾›åº”å•† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚  è‡ªå®šä¹‰ API ç«¯ç‚¹                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ API åœ°å€:                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ [https://api.example.com/v1]    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ API Key:                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ [******************]            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ æ¨¡å‹åç§°:                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ [custom-model-name]             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ [æµ‹è¯•è¿æ¥]  [ä¿å­˜é…ç½®]         â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### åŠŸèƒ½è¯¦è§£

**å®˜æ–¹ä¾›åº”å•†é…ç½®**
1. **Claude (Anthropic)**
   - API Key è¾“å…¥ï¼ˆåŠ å¯†æ˜¾ç¤ºï¼‰
   - æ¨¡å‹ä¸‹æ‹‰é€‰æ‹©:
     - claude-opus-4-6
     - claude-sonnet-4-5-20250929
     - claude-haiku-4-5

2. **OpenAI**
   - API Key è¾“å…¥ï¼ˆåŠ å¯†æ˜¾ç¤ºï¼‰
   - æ¨¡å‹ä¸‹æ‹‰é€‰æ‹©:
     - gpt-4-turbo
     - gpt-4
     - gpt-3.5-turbo

**ä¸‰æ–¹ä¾›åº”å•†é…ç½®**
1. **è‡ªå®šä¹‰ API ç«¯ç‚¹**
   - API åœ°å€è¾“å…¥ï¼ˆæ”¯æŒå…¼å®¹ OpenAI æ ¼å¼çš„ç«¯ç‚¹ï¼‰
   - API Key è¾“å…¥
   - æ¨¡å‹åç§°è¾“å…¥ï¼ˆè‡ªå®šä¹‰ï¼‰

2. **åŠŸèƒ½æŒ‰é’®**
   - **æµ‹è¯•è¿æ¥**: éªŒè¯ API é…ç½®æ˜¯å¦æ­£ç¡®
   - **ä¿å­˜é…ç½®**: ä¿å­˜é…ç½®åˆ°æœ¬åœ°åŠ å¯†å­˜å‚¨

#### å®‰å…¨ç‰¹æ€§

- **åŠ å¯†å­˜å‚¨**: API Key æœ¬åœ°åŠ å¯†å­˜å‚¨
- **æ˜¾ç¤ºä¿æŠ¤**: è¾“å…¥æ¡†æ˜¾ç¤ºä¸º `***` é®ç½©
- **è¿æ¥æµ‹è¯•**: ä¿å­˜å‰éªŒè¯ API å¯ç”¨æ€§

---

### æœªæ¥è§„åˆ’ (Future Plans)

#### Task Tracker çª—å£ï¼ˆç¬¬äºŒç‰ˆæ”¯æŒï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Task Tracker Window (1000x800)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  çœ‹æ¿å¼ä»»åŠ¡ç®¡ç†                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ TODO â”‚  â”‚ DOINGâ”‚  â”‚ DONE â”‚  â”‚REVIEWâ”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                 â”‚
â”‚  åŠŸèƒ½:                                          â”‚
â”‚  - ä»»åŠ¡åˆ›å»ºä¸ç®¡ç†                               â”‚
â”‚  - çŠ¶æ€æ‹–æ‹½åˆ‡æ¢                                 â”‚
â”‚  - æ—¶é—´è·Ÿè¸ª                                     â”‚
â”‚  - AI ç”Ÿæˆä»»åŠ¡å»ºè®®                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è®¡åˆ’åŠŸèƒ½**:
- Kanban çœ‹æ¿è§†å›¾
- ä»»åŠ¡çŠ¶æ€ç®¡ç†
- æ—¶é—´ç»Ÿè®¡
- AI ä»»åŠ¡å»ºè®®

---

## çŠ¶æ€ç®¡ç† (State Management)

### WindowState ç±»å‹å®šä¹‰

```typescript
type WindowState = 'ball' | 'header' | 'asker';
```

### çŠ¶æ€æœºè®¾è®¡

```
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚        Initial State            â”‚
     â”‚          (Ball)                 â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       â”‚
    â”‚ Mouse Enter           â”‚ Click
    â”‚ (200ms delay)         â”‚
    â”‚                       â”‚
    â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Header  â”‚           â”‚  Asker   â”‚
â”‚ (360x72) â”‚           â”‚(360x480) â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                      â”‚
     â”‚ Mouse Leave          â”‚ Click Outside
     â”‚ (300ms delay)        â”‚ or ESC
     â”‚                      â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Ball   â”‚
         â”‚ (64x64)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### çŠ¶æ€è½¬æ¢é€»è¾‘

```typescript
async function switchTo(state: WindowState) {
  if (currentState === state) return;

  currentState = state;

  // éšè—æ‰€æœ‰çŠ¶æ€
  ballState?.classList.add('hidden');
  headerState?.classList.add('hidden');
  askerState?.classList.add('hidden');

  // æ˜¾ç¤ºç›®æ ‡çŠ¶æ€å¹¶è°ƒç”¨åç«¯å‘½ä»¤
  switch (state) {
    case 'ball':
      ballState?.classList.remove('hidden');
      await invoke('collapse_to_ball');
      break;
    case 'header':
      headerState?.classList.remove('hidden');
      await invoke('expand_to_header');
      break;
    case 'asker':
      askerState?.classList.remove('hidden');
      await invoke('expand_to_asker');
      break;
  }
}
```

### äº‹ä»¶å¤„ç†

| äº‹ä»¶ | å½“å‰çŠ¶æ€ | ç›®æ ‡çŠ¶æ€ | å»¶è¿Ÿ | Tauri Command |
|------|----------|----------|------|---------------|
| `mouseenter` | ball | header | 200ms | `expand_to_header` |
| `mouseleave` | header | ball | 300ms | `collapse_to_ball` |
| `click` (çƒ) | ball/header | asker | 0ms | `expand_to_asker` |
| `click` (å¤–éƒ¨) | asker | ball | 0ms | `collapse_to_ball` |
| `ESC` é”® | asker | ball | 0ms | `collapse_to_ball` |

---

## äº¤äº’æµç¨‹ (Interaction Flow)

### å®Œæ•´äº¤äº’é€»è¾‘æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨å¯åŠ¨æµç¨‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  å¼€æœºè‡ªå¯åŠ¨        â”‚
              â”‚  å³ä¸Šè§’æ‚¬æµ®çƒ      â”‚
              â”‚  (64x64)          â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚               â”‚
        â–¼               â–¼               â–¼
  é¼ æ ‡æ‚¬åœ        é¼ æ ‡ç‚¹å‡»      ç‚¹å‡»å¤–éƒ¨åŒºåŸŸ
   (200ms)                        â”‚
        â”‚               â”‚               â”‚
        â–¼               â–¼               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    æŠ˜å å›æ‚¬æµ®çƒ
  â”‚ Header  â”‚     â”‚ Asker   â”‚
  â”‚ å±•å¼€    â”‚     â”‚ å±•å¼€    â”‚
  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
       â”‚               â”‚
  â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”          â”‚
  â”‚    â”‚    â”‚          â”‚
  â–¼    â–¼    â–¼          â–¼
è®°å¿†  è®°å¿†  æé†’     å¤šè½®å¯¹è¯
å¼€å…³  ç®¡ç†  ç®¡ç†     å‘é‡æœç´¢
      â”‚     â”‚
      â–¼     â–¼
   æ‰“å¼€æ–°çª—å£
   (ç‹¬ç«‹è¿è¡Œ)
```

### 0. å¼€æœºè‡ªå¯åŠ¨æµç¨‹

```
ç³»ç»Ÿå¯åŠ¨
    â†“
Vision-Jarvis è‡ªåŠ¨å¯åŠ¨ (å¦‚æœå¯ç”¨)
    â†“
æ˜¾ç¤ºå¯åŠ¨æé†’ï¼ˆå¯é€‰ï¼‰
    â†“
å¼¹çª—æ˜¾ç¤ºæ¿€åŠ±æ–‡æœ¬
    â†“
ç”¨æˆ·å…³é—­æé†’
    â†“
æ‚¬æµ®çƒå‡ºç°åœ¨å³ä¸Šè§’ (Ball çŠ¶æ€)
```

### 1. åº”ç”¨å¯åŠ¨æµç¨‹

```
User launches app
    â†“
Tauri creates floating-ball window
    â†“
Load /floating-ball route
    â†“
Show Ball state (64x64)
    â†“
Position at top-right (x:1800, y:50)
    â†“
Apply: transparent, alwaysOnTop, skipTaskbar
    â†“
Ready for interaction
```

### 2. æ‚¬æµ®çƒäº¤äº’æµç¨‹

```
User hovers over Ball
    â†“
Wait 200ms (debounced)
    â†“
invoke('expand_to_header')
    â†“
Tauri resizes window to 360x72
    â†“
Show Header component
    â†“
User can:
  - Toggle memory
  - Click "è®°å¿†" â†’ open_memory_window
  - Click "æé†’" â†’ open_popup_setting_window
    â†“
User moves mouse away
    â†“
Wait 300ms
    â†“
invoke('collapse_to_ball')
    â†“
Tauri resizes window to 64x64
    â†“
Show Ball component
```

### 3. æ‰“å¼€ Memory çª—å£æµç¨‹

```
User clicks "è®°å¿†" button in Header
    â†“
invoke('open_memory_window')
    â†“
Rust checks if window exists
    â†“
IF exists:
  window.set_focus() â†’ Bring to front
ELSE:
  WebviewWindowBuilder::new(...)
  .label("memory")
  .url("/memory")
  .inner_size(1200, 800)
  .build()
    â†“
Memory window opens/focuses
    â†“
Floating ball remains in current state
```

### 4. æ‰“å¼€ Popup-Setting çª—å£æµç¨‹

```
User clicks "æé†’" button in Header
    â†“
invoke('open_popup_setting_window')
    â†“
Rust checks if window exists
    â†“
IF exists:
  window.set_focus() â†’ Bring to front
ELSE:
  WebviewWindowBuilder::new(...)
  .label("popup-setting")
  .url("/popup-setting")
  .inner_size(900, 700)
  .build()
    â†“
Popup-Setting window opens/focuses
    â†“
Floating ball remains in current state
```

### 5. Asker äº¤äº’æµç¨‹ï¼ˆå‘é‡æœç´¢é—®ç­”ï¼‰

```
ç”¨æˆ·ç‚¹å‡»æ‚¬æµ®çƒ
    â†“
invoke('expand_to_asker')
    â†“
Tauri è°ƒæ•´çª—å£å¤§å°åˆ° 360x480
    â†“
æ˜¾ç¤º Asker ç»„ä»¶
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·è¾“å…¥é—®é¢˜                       â”‚
â”‚  "æˆ‘æ˜¨å¤©ä¸Šåˆåšäº†ä»€ä¹ˆï¼Ÿ"             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    ç‚¹å‡»å‘é€ / æŒ‰ Enter
               â†“
    invoke('search_memories', { query })
               â†“
    åç«¯å‘é‡æœç´¢
    â”œâ”€ å°†é—®é¢˜è½¬æ¢ä¸ºå‘é‡
    â”œâ”€ åœ¨å‘é‡æ•°æ®åº“ä¸­æœç´¢ç›¸ä¼¼è®°å¿†
    â””â”€ è¿”å›æœ€ç›¸å…³çš„è®°å¿†ç‰‡æ®µ
               â†“
    AI ç”Ÿæˆå›ç­”ï¼ˆåŸºäºæ£€ç´¢ç»“æœï¼‰
               â†“
    å‰ç«¯æ˜¾ç¤ºå›ç­”åœ¨å¯¹è¯æ¡†ä¸­
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¯¹è¯å†å²ä¿æŒ                       â”‚
â”‚  - é—®é¢˜: æˆ‘æ˜¨å¤©ä¸Šåˆåšäº†ä»€ä¹ˆï¼Ÿ       â”‚
â”‚  - å›ç­”: æ ¹æ®è®°å½•ï¼Œæ˜¨å¤©ä¸Šåˆ...      â”‚
â”‚                                     â”‚
â”‚  [æ”¯æŒç»§ç»­è¿½é—®]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚
        â–¼             â–¼
   ç»§ç»­æé—®      ç‚¹å‡»å¤–éƒ¨/ESC
        â”‚             â”‚
        â”‚             â–¼
        â”‚    invoke('collapse_to_ball')
        â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€ å›åˆ° Ball çŠ¶æ€
```

**å‘é‡æœç´¢ç‰¹æ€§**:
- è¯­ä¹‰ç†è§£ï¼šç†è§£é—®é¢˜æ„å›¾ï¼Œä¸ä»…ä»…æ˜¯å…³é”®è¯åŒ¹é…
- å¤šè½®å¯¹è¯ï¼šä¿æŒä¸Šä¸‹æ–‡ï¼Œæ”¯æŒè¿ç»­è¿½é—®
- æ™ºèƒ½æ¨èï¼šåŸºäºè®°å¿†å†…å®¹çš„å…³è”æ¨è

**ç”¨æˆ·ä½“éªŒä¼˜åŒ–**:
- è¾“å…¥æ¡†è‡ªåŠ¨èšç„¦
- æ”¯æŒ Enter å¿«æ·å‘é€
- æ”¯æŒ ESC å¿«é€Ÿå…³é—­
- å¯¹è¯å†å²æ»šåŠ¨åˆ°æœ€æ–°

---

## æŠ€æœ¯å®ç°ç»†èŠ‚ (Technical Implementation)

### Tauri Commands

#### çª—å£ç®¡ç†å‘½ä»¤

```rust
// src-tauri/src/commands/window.rs

#[tauri::command]
pub async fn expand_to_header(app: AppHandle) -> Result<ApiResponse<bool>, String> {
    if let Some(window) = app.get_webview_window("floating-ball") {
        window.set_size(PhysicalSize::new(360, 72))
            .map_err(|e| e.to_string())?;
        Ok(ApiResponse::success(true))
    } else {
        Err("Floating ball window not found".to_string())
    }
}

#[tauri::command]
pub async fn expand_to_asker(app: AppHandle) -> Result<ApiResponse<bool>, String> {
    if let Some(window) = app.get_webview_window("floating-ball") {
        window.set_size(PhysicalSize::new(360, 480))
            .map_err(|e| e.to_string())?;
        Ok(ApiResponse::success(true))
    } else {
        Err("Floating ball window not found".to_string())
    }
}

#[tauri::command]
pub async fn collapse_to_ball(app: AppHandle) -> Result<ApiResponse<bool>, String> {
    if let Some(window) = app.get_webview_window("floating-ball") {
        window.set_size(PhysicalSize::new(64, 64))
            .map_err(|e| e.to_string())?;
        Ok(ApiResponse::success(true))
    } else {
        Err("Floating ball window not found".to_string())
    }
}

#[tauri::command]
pub async fn open_memory_window(app: AppHandle) -> Result<ApiResponse<bool>, String> {
    if let Some(window) = app.get_webview_window("memory") {
        window.set_focus().map_err(|e| e.to_string())?;
        return Ok(ApiResponse::success(true));
    }

    WebviewWindowBuilder::new(
        &app,
        "memory",
        WebviewUrl::App("/memory".into())
    )
    .title("è®°å¿†ç®¡ç† - Vision Jarvis")
    .inner_size(1200.0, 800.0)
    .resizable(true)
    .center()
    .build()
    .map_err(|e| e.to_string())?;

    Ok(ApiResponse::success(true))
}

#[tauri::command]
pub async fn open_popup_setting_window(app: AppHandle) -> Result<ApiResponse<bool>, String> {
    if let Some(window) = app.get_webview_window("popup-setting") {
        window.set_focus().map_err(|e| e.to_string())?;
        return Ok(ApiResponse::success(true));
    }

    WebviewWindowBuilder::new(
        &app,
        "popup-setting",
        WebviewUrl::App("/popup-setting".into())
    )
    .title("æé†’è®¾ç½® - Vision Jarvis")
    .inner_size(900.0, 700.0)
    .resizable(true)
    .center()
    .build()
    .map_err(|e| e.to_string())?;

    Ok(ApiResponse::success(true))
}
```

### å‰ç«¯é¡µé¢å®ç°

#### Floating Ball é¡µé¢ç»“æ„

```astro
---
// vision-jarvis/src/pages/floating-ball.astro
import Layout from '../layouts/Layout.astro';
import Ball from '../components/FloatingBall/Ball.astro';
import Header from '../components/FloatingBall/Header.astro';
import Asker from '../components/FloatingBall/Asker.astro';
---

<Layout>
  <div id="floating-container" class="w-full h-full">
    <!-- Ball State (default) -->
    <div id="ball-state">
      <Ball />
    </div>

    <!-- Header State (on hover) -->
    <div id="header-state" class="hidden">
      <Header />
    </div>

    <!-- Asker State (on click) -->
    <div id="asker-state" class="hidden">
      <Asker />
    </div>
  </div>

  <script>
    // State management and event handlers
    // (See State Management section for details)
  </script>
</Layout>
```

#### Ball ç»„ä»¶

```astro
<!-- vision-jarvis/src/components/FloatingBall/Ball.astro -->
<div
  id="floating-ball"
  class="w-16 h-16 rounded-full gradient-primary flex items-center justify-center cursor-pointer transition-all duration-300 hover:scale-110 pulse-glow"
>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="32"
    height="32"
    viewBox="0 0 24 24"
    fill="none"
    stroke="white"
    stroke-width="2"
    class="lucide lucide-brain"
  >
    <!-- Brain icon paths -->
  </svg>
</div>

<style>
  #floating-ball {
    -webkit-app-region: drag;
  }
</style>
```

---

## æ€§èƒ½ä¼˜åŒ– (Performance Optimizations)

### 1. é˜²æŠ– (Debounce)

```typescript
// æ‚¬åœäº‹ä»¶é˜²æŠ–ï¼Œé¿å…é¢‘ç¹è°ƒç”¨
let hoverTimer: NodeJS.Timeout | null = null;

floatingBall?.addEventListener('mouseenter', () => {
  if (currentState !== 'ball') return;

  hoverTimer = setTimeout(() => {
    switchTo('header');
  }, 200); // 200ms å»¶è¿Ÿ
});

floatingBall?.addEventListener('mouseleave', () => {
  if (hoverTimer) {
    clearTimeout(hoverTimer);
    hoverTimer = null;
  }
});
```

### 2. GPU åŠ é€Ÿ

```css
.transition-all {
  will-change: transform, opacity;
  transform: translateZ(0); /* å¼ºåˆ¶GPUåŠ é€Ÿ */
}
```

### 3. çª—å£å¤ç”¨

```rust
// æ£€æŸ¥çª—å£æ˜¯å¦å·²å­˜åœ¨ï¼Œé¿å…é‡å¤åˆ›å»º
if let Some(window) = app.get_webview_window("memory") {
    window.set_focus().map_err(|e| e.to_string())?;
    return Ok(ApiResponse::success(true));
}

// ä»…åœ¨çª—å£ä¸å­˜åœ¨æ—¶åˆ›å»ºæ–°çª—å£
WebviewWindowBuilder::new(...)
```

### 4. æŒ‰éœ€æ¸²æŸ“

```astro
<!-- ä»…åœ¨éœ€è¦æ—¶æ¸²æŸ“å¤æ‚ç»„ä»¶ -->
<div id="asker-state" class="hidden">
  <Asker />
</div>

<!-- é€šè¿‡æ˜¾ç¤º/éšè—è€Œéé”€æ¯/åˆ›å»ºæ¥åˆ‡æ¢çŠ¶æ€ -->
<script>
  askerState?.classList.remove('hidden'); // Show
  askerState?.classList.add('hidden');    // Hide
</script>
```

### 5. CSS åŠ¨ç”»ä¼˜åŒ–

```css
/* ä½¿ç”¨ transform å’Œ opacityï¼Œé¿å… layout reflow */
.expand-animation {
  transition: transform 300ms ease-out, opacity 300ms ease-out;
}

/* é¿å…ä½¿ç”¨ width/height åŠ¨ç”» */
/* âŒ Bad */
.bad {
  transition: width 300ms;
}

/* âœ… Good */
.good {
  transition: transform 300ms;
  transform: scaleX(1.5);
}
```

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… |
|------|------|------|
| é¦–æ¬¡å¯åŠ¨æ—¶é—´ | < 1s | ~140ms (è·¯ç”±åŠ è½½) |
| çŠ¶æ€åˆ‡æ¢æ—¶é—´ | < 300ms | 200-400ms |
| ç©ºé—²æ—¶ CPU å ç”¨ | < 5% | < 5% (å·²éªŒè¯) |
| å†…å­˜å ç”¨ | < 100MB | å¾…æµ‹é‡ |
| çª—å£å“åº”æ—¶é—´ | < 100ms | å¾…æµ‹é‡ |

---

## æ–‡ä»¶ç»„ç»‡ (File Organization)

### é¡¹ç›®ç»“æ„

```
vision-jarvis/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ floating-ball.astro       # æ‚¬æµ®çƒä¸»é¡µé¢
â”‚   â”‚   â”œâ”€â”€ memory.astro              # è®°å¿†ç®¡ç†çª—å£
â”‚   â”‚   â””â”€â”€ popup-setting.astro       # è®¾ç½®çª—å£
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ FloatingBall/
â”‚   â”‚   â”‚   â”œâ”€â”€ Ball.astro            # çƒçŠ¶æ€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.astro          # HeaderçŠ¶æ€ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ Asker.astro           # AskerçŠ¶æ€ç»„ä»¶
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Header/
â”‚   â”‚   â”‚   â””â”€â”€ (existing components)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ Asker/
â”‚   â”‚       â””â”€â”€ (existing components)
â”‚   â”‚
â”‚   â””â”€â”€ styles/
â”‚       â””â”€â”€ global.css                # å…¨å±€æ ·å¼
â”‚
â””â”€â”€ src-tauri/
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ commands/
    â”‚   â”‚   â”œâ”€â”€ window.rs             # çª—å£ç®¡ç†å‘½ä»¤
    â”‚   â”‚   â””â”€â”€ mod.rs
    â”‚   â”‚
    â”‚   â””â”€â”€ lib.rs                    # æ³¨å†Œ commands
    â”‚
    â””â”€â”€ tauri.conf.json               # çª—å£é…ç½®
```

### å…³é”®æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | ç”¨é€” | è¡Œæ•° |
|------|------|------|
| `tauri.conf.json` | Tauri çª—å£é…ç½® | ~46 |
| `commands/window.rs` | çª—å£ç®¡ç†å‘½ä»¤ | ~130 |
| `pages/floating-ball.astro` | æ‚¬æµ®çƒä¸»é¡µé¢ | ~200+ |
| `components/FloatingBall/Ball.astro` | çƒçŠ¶æ€ UI | ~50 |
| `components/FloatingBall/Header.astro` | Header çŠ¶æ€ UI | ~70 |
| `components/FloatingBall/Asker.astro` | Asker çŠ¶æ€ UI | ~100 |
| `pages/memory.astro` | è®°å¿†çª—å£ï¼ˆé‡æ„ï¼‰ | ~200 |
| `pages/popup-setting.astro` | è®¾ç½®çª—å£ï¼ˆé‡æ„ï¼‰ | ~180 |

---

## å…³é”®è®¾è®¡å†³ç­–

### 1. ä¸ºä»€ä¹ˆé€‰æ‹©å¤šçª—å£è€Œéå•çª—å£?

| æ–¹æ¡ˆ | ä¼˜åŠ¿ | åŠ£åŠ¿ | å†³ç­– |
|------|------|------|------|
| **å•çª—å£** | ç®€å•ï¼Œæ˜“ç®¡ç† | åŠŸèƒ½è€¦åˆï¼Œè§†è§‰å¹²æ‰°å¤§ | âŒ |
| **å¤šçª—å£** | å…³æ³¨ç‚¹åˆ†ç¦»ï¼Œå¯å¹¶è¡Œæ“ä½œ | éœ€è¦çª—å£é€šä¿¡ | âœ… é€‰æ‹© |

**åŸå› **:
- æ‚¬æµ®çƒéœ€è¦å§‹ç»ˆå¯è§ä¸”ä¸å¹²æ‰°
- Memory å’Œ Settings æ˜¯é‡å‹åŠŸèƒ½ï¼Œç‹¬ç«‹çª—å£ä½“éªŒæ›´å¥½
- ç”¨æˆ·å¯èƒ½éœ€è¦åŒæ—¶æŸ¥çœ‹è®°å¿†å’Œé…ç½®è®¾ç½®

### 2. ä¸ºä»€ä¹ˆæ˜¯ 64x64 â†’ 360x72 â†’ 360x480?

| å°ºå¯¸ | è®¾è®¡ç†ç”± |
|------|----------|
| **64x64** | æœ€å°å¯è§å°ºå¯¸ï¼Œä¸é®æŒ¡å†…å®¹ï¼Œç¬¦åˆ macOS é£æ ¼ |
| **360x72** | è¶³å¤Ÿå®¹çº³ 3 ä¸ªæŒ‰é’® + Toggleï¼Œå•è¡Œå¸ƒå±€ |
| **360x480** | å¸¸è§èŠå¤©çª—å£é«˜åº¦ï¼Œé¿å…æ»šåŠ¨ |

**é»„é‡‘æ¯”ä¾‹è€ƒé‡**:
- 64:360 = 1:5.625 (æ¥è¿‘é»„é‡‘æ¯”ä¾‹)
- 72:480 = 1:6.67 (åˆç†çš„é«˜å®½æ¯”)

### 3. ä¸ºä»€ä¹ˆæ‚¬åœç”¨ 200msï¼Œç¦»å¼€ç”¨ 300ms?

**ç ”ç©¶ä¾æ®**:
- **200ms**: äººç±»æ„ŸçŸ¥å»¶è¿Ÿé˜ˆå€¼ï¼Œæ„Ÿè§‰å³æ—¶ä½†ä¸è¯¯è§¦
- **300ms**: ç»™ç”¨æˆ·è¶³å¤Ÿæ—¶é—´ç§»åŠ¨åˆ° Header æŒ‰é’®ï¼Œé¿å…è¿‡æ—©æŠ˜å 

**ç”¨æˆ·ä½“éªŒ**:
- æ‚¬åœ â†’ å¿«é€Ÿå“åº”
- ç¦»å¼€ â†’ å®¹é”™æ—¶é—´

### 4. ä¸ºä»€ä¹ˆ Memory æ˜¯ 1200x800ï¼ŒSettings æ˜¯ 900x700?

| çª—å£ | å°ºå¯¸ | è®¾è®¡ç†ç”± |
|------|------|----------|
| **Memory** | 1200x800 | åŒæ å¸ƒå±€ï¼ˆSidebar + Contentï¼‰ï¼Œéœ€è¦æ¨ªå‘ç©ºé—´å±•ç¤ºæ—¶é—´çº¿ |
| **Settings** | 900x700 | å•æ å¡ç‰‡å¸ƒå±€ï¼Œæ›´çª„å³å¯ï¼Œé¿å…å¡ç‰‡è¿‡å®½ |

**å‚è€ƒæ ‡å‡†**:
- 1200x800: æ¥è¿‘ 15" MacBook çš„ 80% å±å¹•å®½åº¦
- 900x700: æ¥è¿‘ 13" MacBook çš„ 70% å±å¹•å®½åº¦

### 5. ä¸ºä»€ä¹ˆé€‰æ‹© Astro è€Œéçº¯ React?

| æ–¹æ¡ˆ | æ‰“åŒ…ä½“ç§¯ | é¦–å±æ€§èƒ½ | äº¤äº’èƒ½åŠ› | å†³ç­– |
|------|----------|----------|----------|------|
| **çº¯ React** | ~150KB | æ…¢ | å¼º | âŒ |
| **Astro + React Islands** | ~50KB | å¿« | å¼º | âœ… é€‰æ‹© |

**åŸå› **:
- æ‚¬æµ®çƒéœ€è¦æå¿«åŠ è½½
- å¤§éƒ¨åˆ†å†…å®¹æ˜¯é™æ€çš„ï¼ˆBall UIï¼‰
- ä»…äº¤äº’éƒ¨åˆ†éœ€è¦ JS

---

## æµ‹è¯•å’ŒéªŒè¯

### E2E æµ‹è¯•æ¸…å•

å·²é€šè¿‡æµ‹è¯•ï¼ˆ2026-02-06ï¼‰:

1. âœ… åº”ç”¨å¯åŠ¨æ˜¾ç¤ºæ‚¬æµ®çƒï¼ˆå³ä¸Šè§’ï¼‰
2. âœ… æ‚¬æµ®çƒå¯ä»¥æ‹–åŠ¨
3. âœ… é¼ æ ‡æ‚¬åœå±•å¼€ä¸º Header
4. âœ… Header æ˜¾ç¤ºè®°å¿†toggleã€è®°å¿†æŒ‰é’®ã€æé†’æŒ‰é’®
5. âœ… ç‚¹å‡»æ‚¬æµ®çƒå±•å¼€ä¸º Asker
6. âœ… ç‚¹å‡»å¤–éƒ¨åŒºåŸŸæŠ˜å å›æ‚¬æµ®çƒ
7. âœ… ç‚¹å‡»"è®°å¿†"æŒ‰é’®æ‰“å¼€ Memory çª—å£
8. âœ… ç‚¹å‡»"æé†’"æŒ‰é’®æ‰“å¼€ Popup-Setting çª—å£
9. âœ… Memory çª—å£å¯ä»¥ç‹¬ç«‹æ“ä½œ
10. âœ… Popup-Setting çª—å£å¯ä»¥ç‹¬ç«‹æ“ä½œ
11. âœ… æ‚¬æµ®çƒå§‹ç»ˆä¿æŒåœ¨æœ€é¡¶å±‚

### å·²ä¿®å¤çš„å…³é”® Bug

**Bug #1: çª—å£æ ‡ç­¾ä¸åŒ¹é…** (CRITICAL - å·²ä¿®å¤)
- **é—®é¢˜**: tauri.conf.json ä½¿ç”¨ "floating-ball"ï¼Œä½† window.rs å¼•ç”¨ "main"
- **å½±å“**: æ‰€æœ‰çª—å£ resize å‘½ä»¤å¤±è´¥
- **ä¿®å¤**: æ›´æ–°æ‰€æœ‰ window.rs ä¸­çš„çª—å£å¼•ç”¨ä¸º "floating-ball"

**Bug #2: macOS é€æ˜åº¦è­¦å‘Š** (MEDIUM - å·²ä¿®å¤)
- **é—®é¢˜**: `transparent: true` ä½†æœªå¯ç”¨ macOS private API
- **å½±å“**: é€æ˜æ•ˆæœå¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œ
- **ä¿®å¤**: æ·»åŠ  `"macOSPrivateApi": true` åˆ° tauri.conf.json

### æµ‹è¯•æŠ¥å‘Š

è¯¦è§: [E2E Test Report](../../testing/test-reports/2026-02-06-floating-ball-e2e.md)

---

## æœªæ¥æ”¹è¿›æ–¹å‘

### è®¡åˆ’ä¸­çš„åŠŸèƒ½

1. **å¿«æ·é”®æ”¯æŒ**: å…¨å±€å¿«æ·é”®æ˜¾ç¤º/éšè—æ‚¬æµ®çƒ
2. **å¤šå±æ”¯æŒ**: è®°ä½æ¯ä¸ªå±å¹•çš„æ‚¬æµ®çƒä½ç½®
3. **ä¸»é¢˜åˆ‡æ¢**: æ”¯æŒæµ…è‰²/æ·±è‰²ä¸»é¢˜
4. **åŠ¨ç”»å¢å¼º**: æ›´æµç•…çš„çŠ¶æ€åˆ‡æ¢åŠ¨ç”»
5. **çª—å£è®°å¿†**: è®°ä½ç”¨æˆ·è°ƒæ•´çš„çª—å£å¤§å°å’Œä½ç½®

### æ€§èƒ½ä¼˜åŒ–æ–¹å‘

1. **è™šæ‹Ÿæ»šåŠ¨**: Memory çª—å£çš„é•¿åˆ—è¡¨ä¼˜åŒ–
2. **æ‡’åŠ è½½**: Asker ç»„ä»¶æŒ‰éœ€åŠ è½½
3. **ç¼“å­˜ç­–ç•¥**: è®°å¿†æ•°æ®æœ¬åœ°ç¼“å­˜
4. **å¢é‡æ›´æ–°**: ä»…æ›´æ–°å˜åŒ–çš„æ•°æ®

---

## ç›¸å…³æ–‡æ¡£

- [Frontend Architecture V1](architecture.md) - å•é¡µé¢æ¶æ„ï¼ˆå·²åºŸå¼ƒï¼‰
- [FloatingOrb Component](components/FloatingOrb.md)
- [Header Component](components/Header.md)
- [Asker Component](components/Asker.md)
- [Memory Page](pages/memory.md)
- [Popup-Setting Page](pages/popup-setting.md)
- [E2E Test Report](../testing/test-reports/2026-02-06-floating-ball-e2e.md)
- [Implementation Plan](../plans/2026-02-06-floating-ball-multi-window-architecture.md)

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Vision-Jarvis æ¶æ„å›¢é˜Ÿ
**å®¡æ ¸çŠ¶æ€**: âœ… å·²å®¡æ ¸
**æœ€åæ›´æ–°**: 2026-02-06
**æ¶æ„ç‰ˆæœ¬**: V2.0
